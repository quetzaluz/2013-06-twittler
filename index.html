<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
	<script src="jquery.timeago.js"></script>
    <script src="data_generator.js"></script>
	<link rel="stylesheet" type="text/css" href="index.css">
  </head>
  <body>
  <div id="tweetBox"></div>
    <script>
      //functions to be called in interval
	  var showStream = function (stream) {
	    var index = stream.length - 1;
		var limit;
		if (stream == streams.home) limit = stream.length - 20;
		else limit = -(stream.length);
		var $body = $('body');
        var $tweetBox = $('#tweetBox');
        $tweetBox.html(''); 
		while(index >= limit){
		  $tweetBox.css('height', $(window).height() - 32 + 'px');
          var tweet = stream[index];
		  var $tweet = $('<div class = tweet1></div>'); 
          var $tweetText = $('<div class = "tweetText"></div>');
          var $tweetTime = $('<div class = "tweetTime"></div>');
		  var $tweetUser = $("<div class = 'tweetUser'></div>");
		  $tweetUser.text("@" + tweet.user);
          $tweetText.text(": " + tweet.message);
          $tweetTime.text(jQuery.timeago(tweet.created_at));
		  $tweetUser.appendTo($tweet);
          $tweetText.appendTo($tweet);
          $tweetTime.appendTo($tweet);
		  $tweet.appendTo($tweetBox);
		  index -= 1;
		}
	  }

	  var setStream = function (user) {
		//user, home, or no arg to return source array val
		var home, stream;
		if (user === "home") stream = streams.home;
		else if (user === null) return;
		else stream = streams.users.user;
		return stream;
	  }

      $(document).ready(function(){
	    $("abbr.timeago").timeago(); //attaching time func
        var intervalID = setInterval(function (){showStream(setStream("home"))}, 900);
		//Will have filtering soon..
		//Trying to figure out how to toggle it.
		//showStream(streams.users.mracus) works
		//however, not yet toggled by clicking name.
		//showStream(setStream($#user)) or somesuch.	
      });
    </script>
  </body>
</html>
